$(function(){Metronic.init();Layout.init();QuickSidebar.init();Demo.init();$("#cancle").click(function(){history.go(-1)});$("#payName").change(function(c){var b=$("#payName").find("option:selected").attr("payCode");$("#form").find("#payCode").val(b)});$.validator.addMethod("isNumOne",function(e,b){var d=e.length;var c=/^[0-9]+(\.[0-9]+)?$/;return this.optional(b)||(c.test(e))},"只能输入数字");$.validator.addMethod("isNumTwo",function(e,d){var c=/^[0]+(\.[0-9]{1,5})?$/;var b=true;if(d.id=="t0Rate"){b=c.test(e)}else{b=c.test(e)&&e!=0}return this.optional(d)||b},"请输入0~1之间的小数，且最多五位小数!");$.validator.addMethod("isnotSpace",function(d,b){var c=d.trim().length;return this.optional(b)||(c!=0)},"不能是空白字符");function a(){var c=$("#payType").val();var d=$("#payCode").val();var e=$("#id").val();var b=false;$.ajax({url:"check",data:{payType:c,payCode:d,id:e},type:"POST",async:false,success:function(f){f=$.parseJSON(f);b=f.check}});return b}$("#form").validate({event:"blur",rules:{payName:{required:true},payType:{required:true},payDesc:{required:true,isnotSpace:true,maxlength:100},t0Rate:{required:true,maxlength:10,isNumTwo:true},t1Rate:{required:true,maxlength:10,isNumTwo:true},rate:{required:true,maxlength:10,isNumOne:true}},messages:{payName:{required:"请输入【支付通道】"},payType:{required:"请输入【通道类型】"},payDesc:{required:"请输入【支付通道描述】",maxlength:"长度不能超过100"},t0Rate:{required:"请输入【垫资费率】",maxlength:"长度不能超过10"},t1Rate:{required:"请输入【交易手续费】",maxlength:"长度不能超过10"},rate:{required:"请输入【提现手续费】",maxlength:"长度不能超过10"}},submitHandler:function(b){var g=0;var e="";var k=$(".form-horizontal input[val='hidden']");for(var d=0;d<k.size();d++){var j=$(k[d]);var c=j.val();if(c==null||c==""){g++;e+=j.attr("name")+"不可为空!<br>"}}if(a()!=true){g++;e+="该支付方式已存在"}if(g==0){$("#save").attr("disabled","disabled");var f=$("#baseUrl").text().trim();var h=$("#form").serialize();$.ajax({url:f+"/adminManage/platfromPayway/save",data:h,type:"POST",success:function(i){i=$.parseJSON(i);bootbox.alert(i.values,function(){if(i.executeStatus=="0"){location.href=f+i.url}})}})}else{bootbox.alert(e,function(){})}return false},errorPlacement:function(b,c){b.appendTo(c.parent().parent())}})});