$(function(){Metronic.init();Layout.init();QuickSidebar.init();Demo.init();$(".date-picker").datepicker({rtl:Metronic.isRTL(),orientation:"left",autoclose:true});$.validator.addMethod("isNum",function(m,j){var i=/^(([0]{1})|([0-9]+)|([0-9]+\.[0]{1,2}))$/;return this.optional(j)||(i.test(m))},"只能输入整数!");$("#cancle").click(function(){history.go(-1)});function d(){var j=$("#merchantNo").val();var i=false;$.ajax({url:"checkMerchantNo",data:{merchantNo:j},type:"POST",async:false,success:function(m){m=$.parseJSON(m);i=m.check}});return i}function f(){var m=$("#merchantNo").val();var o=$("#limitPayCode").val();var j=$("#limitType").val();var n=$("#id").val();var i=false;$.ajax({url:"check",data:{merchantNo:m,limitPayCode:o,limitType:j,id:n},type:"POST",async:false,success:function(p){p=$.parseJSON(p);i=p.check}});return i}$("#form").validate({event:"blur",rules:{merchantNo:{required:true,maxlength:25},limitPayCode:{required:true,maxlength:25},limitType:{required:true,maxlength:25},dayTransLimit:{required:true,maxlength:25,isNum:true},dayWithdrawalsLimit:{required:true,maxlength:25,isNum:true},singleTransLimit:{required:true,maxlength:25,isNum:true},singleWithdrawalsLimit:{required:true,maxlength:25,isNum:true}},messages:{merchantNo:{required:"请输入【商户编号】",maxlength:"长度不能超过25"},limitPayCode:{required:"请选择【限额通道】",maxlength:"长度不能超过25"},limitType:{required:"请选择【限额类型】",maxlength:"长度不能超过25"},dayTransLimit:{required:"请输入【全日交易限额】",maxlength:"长度不能超过25"},dayWithdrawalsLimit:{required:"请输入【全日提现限额】",maxlength:"长度不能超过25"},singleTransLimit:{required:"请输入【单笔交易限额】",maxlength:"长度不能超过25"},singleWithdrawalsLimit:{required:"请输入【单笔提现限额】",maxlength:"长度不能超过25"}},submitHandler:function(o){var i=0;var n="";if(d()!=true){i++;n+="商户编号不存在<br>"}if(f()!=true){i++;n+="此商户已存在通道和类型的限额标准<br>"}if(i==0){$("#save").attr("disabled","disabled");var m=$("#baseUrl").text().trim();var j=$("#form").serialize();$.ajax({url:m+"/adminManage/merchantlimit/save",data:j,type:"POST",success:function(p){p=$.parseJSON(p);bootbox.alert(p.values,function(){if(p.executeStatus=="0"){location.href=m+p.url}})}})}else{bootbox.alert(n,function(){})}return false},errorPlacement:function(i,j){i.appendTo(j.parent().parent())}});var l=$("select.form-control");for(var h=0;h<l.size();h++){var k=$(l[h]);var a=k.attr("id");var c=$("."+a).val();var b=k.find("option");for(var g=0;g<b.size();g++){var e=$(b[g]).val();if(e==c){$(b[g]).attr("selected","selected")}else{$(b[g]).removeClass("selected")}}}});