jQuery.extend({createUploadIframe:function(d,b){var a="jUploadFrame"+d;var c='<iframe id="'+a+'" name="'+a+'" style="position:absolute; top:-9999px; left:-9999px"';if(window.ActiveXObject){if(typeof b=="boolean"){c+=' src="javascript:false"'}else{if(typeof b=="string"){c+=' src="'+b+'"'}}}c+=" />";jQuery(c).appendTo(document.body);return jQuery("#"+a).get(0)},createUploadForm:function(a,k,e,b){var j="jUploadForm"+a;var d="jUploadFile"+a;var c=jQuery('<form  action="" method="POST" name="'+j+'" id="'+j+'" enctype="multipart/form-data"></form>');if(e){for(var f in e){jQuery('<input type="hidden" name="'+f+'" value="'+e[f]+'" />').appendTo(c)}}var g;if(b==null){g=jQuery("#"+k)}else{g=b}var h=jQuery(g).clone();jQuery(g).attr("id",d);jQuery(g).before(h);jQuery(g).appendTo(c);jQuery(c).css("position","absolute");jQuery(c).css("top","-1200px");jQuery(c).css("left","-1200px");jQuery(c).appendTo("body");return c},ajaxFileUpload:function(m){m=jQuery.extend({},jQuery.ajaxSettings,m);var a=new Date().getTime();var b=jQuery.createUploadForm(a,m.fileElementId,(typeof(m.data)=="undefined"?false:m.data),m.fileElement);var k=jQuery.createUploadIframe(a,m.secureuri);var j="jUploadFrame"+a;var l="jUploadForm"+a;if(m.global&&!jQuery.active++){jQuery.event.trigger("ajaxStart")}var c=false;var g={};if(m.global){jQuery.event.trigger("ajaxSend",[g,m])}var d=function(n){var r=document.getElementById(j);try{if(r.contentWindow){g.responseText=r.contentWindow.document.body?r.contentWindow.document.body.innerHTML:null;g.responseXML=r.contentWindow.document.XMLDocument?r.contentWindow.document.XMLDocument:r.contentWindow.document}else{if(r.contentDocument){g.responseText=r.contentDocument.document.body?r.contentDocument.document.body.innerHTML:null;g.responseXML=r.contentDocument.document.XMLDocument?r.contentDocument.document.XMLDocument:r.contentDocument.document}}}catch(q){jQuery.handleError(m,g,null,q)}if(g||n=="timeout"){c=true;var o;try{o=n!="timeout"?"success":"error";if(o!="error"){var p=jQuery.uploadHttpData(g,m.dataType);if(m.success){m.success(p,o)}if(m.global){jQuery.event.trigger("ajaxSuccess",[g,m])}}else{jQuery.handleError(m,g,o)}}catch(q){o="error";jQuery.handleError(m,g,o,q)}if(m.global){jQuery.event.trigger("ajaxComplete",[g,m])}if(m.global&&!--jQuery.active){jQuery.event.trigger("ajaxStop")}if(m.complete){m.complete(g,o)}jQuery(r).unbind();setTimeout(function(){try{jQuery(r).remove();jQuery(b).remove()}catch(s){jQuery.handleError(m,g,null,s)}},100);g=null}};if(m.timeout>0){setTimeout(function(){if(!c){d("timeout")}},m.timeout)}try{var b=jQuery("#"+l);jQuery(b).attr("action",m.url);jQuery(b).attr("method","POST");jQuery(b).attr("target",j);if(b.encoding){jQuery(b).attr("encoding","multipart/form-data")}else{jQuery(b).attr("enctype","multipart/form-data")}jQuery(b).submit();var f=jQuery("#jUploadFile"+a,b);var h=jQuery("#"+m.fileElementId);jQuery(h).replaceWith(f);jQuery(f).attr("id",m.fileElementId)}catch(i){jQuery.handleError(m,g,null,i)}jQuery("#"+j).load(d);return{abort:function(){try{jQuery("#"+j).remove();jQuery(b).remove()}catch(n){}}}},uploadHttpData:function(r,type){var data=!type;data=type=="xml"||data?r.responseXML:r.responseText;if(type=="script"){jQuery.globalEval(data)}if(type=="json"){data=r.responseText;var start=data.indexOf(">");if(start!=-1){var end=data.indexOf("<",start+1);if(end!=-1){data=data.substring(start+1,end)}}eval("data = "+data)}if(type=="html"){jQuery("<div>").html(data).evalScripts()}return data},handleError:function(c,b,a,d){if(c.error){c.error(b,a,d)}if(c.global){jQuery.event.trigger("ajaxError",[b,c,d])}}});