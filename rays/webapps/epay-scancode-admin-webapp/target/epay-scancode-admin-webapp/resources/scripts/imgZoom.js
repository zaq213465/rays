jQuery.fn.fancyZoom=function(i){var i=i||{};var f=i&&i.directory?i.directory:"images";var a=false;if($("#zoom").length==0){var d='<div class="round_shade_box" id="zoom"> 					<div class="round_shade_top"> 						<span class="round_shade_topleft"> </span> 						<span class="round_shade_topright"> </span> 					</div> 					<div class="round_shade_centerleft"> 						<div class="round_shade_centerright"> 							<div class="round_shade_center" id="zoom_content"> </div> 						</div> 					</div> 					<div class="round_shade_bottom"> 						<span class="round_shade_bottomleft"> </span> 						<span class="round_shade_bottomright"> </span> 					</div> 					<a href="#close" class="round_box_close" id="zoom_close">关闭</a> 				</div>';$("body").append(d);$("html").click(function(j){if($(j.target).parents("#zoom:visible").length==0){e()}});$(document).keyup(function(j){if(j.keyCode==27&&$("#zoom:visible").length>0){e()}});$("#zoom_close").click(e)}var h=$("#zoom");var b=$("#zoom_close");var c=$("#zoom_content");this.each(function(j){$($(this).attr("href")).hide();$(this).click(g)});$("#zoom_close").click(e);return this;function g(p){if(a){return false}a=true;var j=$($(this).attr("href"));var n=i.width;var o=i.height;var k=window.innerWidth||(window.document.documentElement.clientWidth||window.document.body.clientWidth);var v=window.innerHeight||(window.document.documentElement.clientHeight||window.document.body.clientHeight);var t=window.pageXOffset||(window.document.documentElement.scrollLeft||window.document.body.scrollLeft);var s=window.pageYOffset||(window.document.documentElement.scrollTop||window.document.body.scrollTop);var w={width:k,height:v,x:t,y:s};var k=(n||j.width())+40;var v=(o||j.height())+40;var q=w;var r=Math.max((q.height/2)-(v/2)+s,0);var u=(q.width/2)-(k/2);var l=p.pageY;var m=p.pageX;b.attr("curTop",l);b.attr("curLeft",m);b.attr("scaleImg",i.scaleImg?"true":"false");$("#zoom").hide().css({position:"absolute",top:l+"px",left:m+"px",width:"1px",height:"1px"});b.hide();if(i.closeOnClick){$("#zoom").click(e)}if(i.scaleImg){c.html(j.html());$("#zoom_content img").css("width","100%")}else{c.html("")}$("#zoom").animate({top:r+"px",left:u+"px",opacity:"show",width:k,height:v},500,null,function(){if(i.scaleImg!=true){c.html(j.html())}b.show();a=false});return false}function e(){if(a){return false}a=true;$("#zoom").unbind("click");if(b.attr("scaleImg")!="true"){c.html("")}b.hide();$("#zoom").animate({top:b.attr("curTop")+"px",left:b.attr("curLeft")+"px",opacity:"hide",width:"1px",height:"1px"},500,null,function(){if(b.attr("scaleImg")=="true"){c.html("")}a=false});return false}};